---
output:
  knitrBootstrap::bootstrap_document:
    theme.chooser: TRUE
    highlight.chooser: TRUE
---

<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{external_openStreetMap}
%\VignetteDepends{xtable}
-->

##Open Street Map data##

The emergency locations dataset contains locations in the London, UK metro and associcates each location with a 'risk' score based on the distance within a 2-mile radius to the nearest fire station or hospital. If only fire station or hospital are in the radius of a point a penalty of 20.0 is added, and if no hospitals or fire stations are in the radius a penalty of 40.0 is added.

<br>
```{r external_openStreetMap_1, eval=TRUE, results='asis'}
emergencyLocations = getData("emergency_locations")
print(xtable(tail(emergencyLocations,n=5)), type='html', comment=F) 
```
<br>
By setting useOpenStreetMap to TRUE, the area around each latLong will be downloaded and the points of interests available in that area will be used during the feature search.
<br>
```{r external_openStreetMap_2, eval=TRUE, message=FALSE, results='hide'}
emergencyLocationsModel = learn(
		projectName = "emergencyLocations_example",
    trainData = emergencyLocations,
    target = "risk",
    featureGenerationCtrl = featureGenerationControl(			 
			maxFeaturesCount = list(5)
		),
		knowledgeCtrl = knowledgeControl(useOpenStreetMap = TRUE),
    modelBuildingCtrl = modelBuildingControl(algorithmsWhiteList = list("RXGBoostRegressor")),    
    autoSave = FALSE
)
```
<br>
```{r external_openStreetMap_3, eval=TRUE, cache=TRUE}
print(emergencyLocationsModel$evaluate()$evaluation$rootMeanSquaredError)
```
<br>
Indeed the top 3 features identify that the target is correlated with short distance to fire stations and hospitals.      
<br>
```{r external_openStreetMap_4, eval=TRUE, results='asis'}
print(xtable(emergencyLocationsModel$features()[1:5,c("idx","feature")]), type='html', comment=F) 
```

