---
output:
  knitrBootstrap::bootstrap_document:
    theme.chooser: TRUE
    highlight.chooser: TRUE
---

<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Example 5}
%\VignetteDepends{xtable}
-->
#Example 5 - Sentiment analysis#
Goal: Identify sentiment in twitter tweets.
<br>
### Tweets sentiment ###
```{r sentiment_example, eval=TRUE, message=FALSE, results='hide'}
tweets = getData("tweets_sentiment")
SentimentModel = learn(projectName="tweets",
              trainData=tweets,
              target="sentiment",
              algorithmsWhiteList = list("RRandomForestClassifier"),
              maxFeaturesCount = list(50),
              evaluationMetric = "AUC",
              autoSave = FALSE)
SentimentEval = SentimentModel$evaluate()
```
<br>
In this example we load a sentiment dataset with a tweet column and a setiment target (-1 or 1). The top feature is a textSentimentScore which is automatically computed.

```{r, eval=TRUE, results='asis'}
library(xtable)
print(xtable(SentimentModel$features()[1:10,c("idx","feature")]), type='html', comment=F) 
writeLines(gsub("\n","<br>",SentimentEval$evaluation$summary))
```

<br>
### Tweets with a context database ###

```{r sentiment_example_with_context, eval=TRUE, message=FALSE, results='hide'}
sentimentLexicon = getData("sentiment_lexicon")
pathLexicon = writeToServer(sentimentLexicon)
tweets = getData("tweets_sentiment")
SentimentModelContext = learn(projectName="tweets",
              trainData=tweets,
              target="sentiment",
              algorithmsWhiteList = list("RRandomForestClassifier"),
              maxFeaturesCount = list(50),
              evaluationMetric = "AUC",
              autoSave = FALSE,
              contextDatasets = list(pathLexicon))

SentimentContextEval = SentimentModelContext$evaluate()
```
<br>

In order to improve performance we can include a custom context Dataset. The sentimentLexicon includes over 6000 single words with a either a positive or negative sentiment. The top features now are actually derived by looking up the values in the lexcion (data_column) and the classificaiton performance is boosted.

```{r, eval=TRUE, results='asis'}
library(xtable)
print(xtable(SentimentModelContext$features()[1:10,c("idx","feature")]), type='html', comment=F) 
writeLines(gsub("\n","<br>",SentimentContextEval$evaluation$summary))
```
