---
output:
  knitrBootstrap::bootstrap_document:
    theme.chooser: TRUE
    highlight.chooser: TRUE
---

<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Example 6}
%\VignetteDepends{xtable}
-->

# Example 6 - content enrichment #
Goal: Flights weather delay
In this example we use data from Kaggele that contains information of flight delays caused due to weather conditions.
This example will show how airport codes (in fields `origin`, `dest`) are automatically identified as airport entities and are enriched with the corresponding latitude and longitude information of the airport.
Moreover, when elements of type date and location are encountered during the feature search, external data including NOAA weather are examined for their distinctive power.
The first run may take more time as weather data will be downloaded and cached (to cancel this behavior set `overrideMaxFeatureDurationForExternalData = FALSE` to prevent the override given by default to external data sources). 
<br>
```{r weather_content_enrichment_example, eval=TRUE, message=FALSE, results='hide'}
flights = getData("flights_delay")
sampledFlights = sampleDataAbsolute(flights, 1000)
flightsModel = learn(projectName = "flights_delay_example",
                        trainData = sampledFlights,
                        target = "weatherDelay",
                        useCustomGraphs = TRUE, 
                        algorithmsWhiteList = list("RRandomForestRegressor"),
                        functionsBlackList = list("trigonometry"),
                        maxFeaturesCount = list(10),
                        autoSave = FALSE
                    )
```
<br>
Note that in this example:

1. The returned object `flightsModel` should include features of the type `weatherAt(<location>, <time>)`.
2. Running using all the flights data will improve RMSE significantly.
<br>

```{r, eval=TRUE, results='asis'}
library(xtable)
print(xtable(flightsModel$features()[1:10,c("idx","feature")]), type='html', comment=F) 
```
